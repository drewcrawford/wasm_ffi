<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
  </head>
  <body>
    <pre id="test_output" style="display:none">Loading scripts...</pre>
    <pre id="console" style="display:none"></pre>
    <script>
     const appendTo = id => (...args) => {
         const el = document.getElementById(id);
         for (const msg of args) {
             el.appendChild(document.createTextNode(`${msg}\n`));
         }
     };

     // {NOCAPTURE}
     const wrap = method => {
         const on_method = `on_console_${method}`;
         console[method] = function (...args) {
             // Always write to #console div for capture
             appendTo("console").apply(this, args);
             // In nocapture mode, also write to test_output for real-time display
             if (nocapture) {
                 appendTo("test_output").apply(this, args);
             }
             if (window[on_method]) {
                 window[on_method](args);
             }
         };
     };

     wrap("debug");
     wrap("log");
     wrap("info");
     wrap("warn");
     wrap("error");

     window.__wbg_test_invoke = f => f();
    </script>
    <!-- {IMPORT_SCRIPTS} -->
  </body>
</html>
